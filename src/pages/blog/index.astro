---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import Hero from '../../components/Hero.astro';

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.date.valueOf() - a.data.date.valueOf()
);

const title = "Ultraviolet Blog";
const description = "Latest news, updates, and insights from the Ultraviolet team on confidential computing and secure AI.";
---

<Layout title={title} description={description}>
	<Header slot="header" />

    <div class="pt-20">
        <Hero 
            title="Ultraviolet Blog"
            description="Insights, updates, and technical deep-dives into Confidential Computing and Secure AI."
        />
    </div>

	<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
		<div class="grid gap-16 lg:grid-cols-3 lg:gap-x-5 lg:gap-y-12">
			{
				posts.map((post) => (
					<div class="flex flex-col rounded-lg shadow-lg overflow-hidden transition-transform hover:-translate-y-1 border border-border bg-card">
						{post.data.image && (
                            <div class="flex-shrink-0">
                                <img class="h-48 w-full object-cover" src={post.data.image} alt={post.data.title} />
                            </div>
                        )}
						<div class="flex-1 bg-card p-6 flex flex-col justify-between">
							<div class="flex-1">
                                {post.data.tags && (
                                    <div class="text-sm font-medium text-primary mb-2">
                                        {post.data.tags.map(tag => (
                                            <span class="mr-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary/10 text-primary">
                                                {tag}
                                            </span>
                                        ))}
                                    </div>
                                )}
								<a href={`/blog/${post.slug}`} class="block mt-2">
									<p class="text-xl font-semibold text-text-main font-heading">{post.data.title}</p>
									<p class="mt-3 text-base text-text-muted line-clamp-3">{post.data.excerpt || post.data.description}</p>
								</a>
							</div>
							<div class="mt-6 flex items-center">
                                {post.data.author && post.data.author.picture && (
                                    <div class="flex-shrink-0">
                                        <a href="#">
                                            <span class="sr-only">{post.data.author.name}</span>
                                            <img class="h-10 w-10 rounded-full" src={post.data.author.picture} alt="" />
                                        </a>
                                    </div>
                                )}
								<div class="ml-3">
                                    {post.data.author && (
									    <p class="text-sm font-medium text-text-main">
										    <a href="#" class="hover:underline">{post.data.author.name}</a>
									    </p>
                                    )}
									<div class="flex space-x-1 text-sm text-text-muted">
										<time datetime={post.data.date.toISOString()}>
											{post.data.date.toLocaleDateString('en-US', {
												year: 'numeric',
												month: 'long',
												day: 'numeric',
											})}
										</time>
									</div>
								</div>
							</div>
						</div>
					</div>
				))
			}
		</div>
	</div>

	<Footer slot="footer" />
</Layout>
